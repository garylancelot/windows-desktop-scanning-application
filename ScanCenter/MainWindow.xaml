<Window x:Class="ScanCenter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Scan Center" Height="900" Width="1380" MinHeight="760" MinWidth="1180"
        Background="{StaticResource PageBackground}">
    <Grid Margin="12">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="360"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="#273043" CornerRadius="14" Padding="10">
            <StackPanel>
                <TextBlock Text="Scan Center" FontSize="26" FontWeight="Bold" Foreground="White" Margin="8,10"/>
                <Button x:Name="HomeNavButton" Content="Home" Click="NavigateHome_Click"/>
                <Button Content="Scan" Click="NavigateScan_Click"/>
                <Button Content="Save / Share" Click="NavigateOutput_Click"/>
                <Button Content="Settings" Click="NavigateSettings_Click"/>
                <Button Content="Help" Click="NavigateHelp_Click"/>
            </StackPanel>
        </Border>

        <Grid Grid.Column="1" Margin="12,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Background="White" CornerRadius="14" Padding="14" Margin="0,0,0,10">
                <TextBlock x:Name="SectionTitleText" Text="Home" FontSize="24" FontWeight="SemiBold"/>
            </Border>

            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel x:Name="MainContentPanel">
                    <UniformGrid Columns="2" Margin="0,0,0,12">
                        <Button Content="Scan a Document" Height="140" FontSize="24" Click="StartDocumentWorkflow_Click"/>
                        <Button Content="Scan a Photo" Height="140" FontSize="24" Click="StartPhotoWorkflow_Click"/>
                        <Button Content="Scan to PDF" Height="140" FontSize="24" Click="StartPdfWorkflow_Click"/>
                        <Button Content="Settings" Height="140" FontSize="24" Click="NavigateSettings_Click"/>
                        <Button Content="Device Status" Height="140" FontSize="24" Click="NavigateDeviceStatus_Click"/>
                    </UniformGrid>

                    <Border Background="White" CornerRadius="14" Padding="12" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Workflow Options" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <WrapPanel>
                                <StackPanel Margin="8">
                                    <TextBlock Text="DPI"/>
                                    <ComboBox x:Name="DpiCombo" Width="130">
                                        <ComboBoxItem Content="150" IsSelected="True"/>
                                        <ComboBoxItem Content="200"/>
                                        <ComboBoxItem Content="300"/>
                                        <ComboBoxItem Content="600"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Margin="8">
                                    <TextBlock Text="Color Mode"/>
                                    <ComboBox x:Name="ColorModeCombo" Width="170">
                                        <ComboBoxItem Content="Color" IsSelected="True"/>
                                        <ComboBoxItem Content="Grayscale"/>
                                        <ComboBoxItem Content="Black and White"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Margin="8">
                                    <TextBlock Text="Output Format"/>
                                    <ComboBox x:Name="OutputFormatCombo" Width="150">
                                        <ComboBoxItem Content="PDF" IsSelected="True"/>
                                        <ComboBoxItem Content="JPEG"/>
                                        <ComboBoxItem Content="PNG"/>
                                        <ComboBoxItem Content="TIFF"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Margin="8">
                                    <TextBlock Text="File Name Template"/>
                                    <TextBox x:Name="TemplateTextBox" Width="220" Text="Scan_{yyyyMMdd_HHmmss}"/>
                                </StackPanel>
                                <StackPanel Margin="8" VerticalAlignment="Bottom">
                                    <CheckBox x:Name="ColorCorrectionCheck" Content="Enable color correction" Margin="0,20,0,0"/>
                                </StackPanel>
                            </WrapPanel>
                            <WrapPanel>
                                <Button Content="Preview" Click="Preview_Click"/>
                                <Button Content="Start Scan" Click="StartScan_Click"/>
                                <Button Content="Scan Next Page" Click="ScanNextPage_Click"/>
                                <Button Content="Open Output Folder" Click="OpenOutputFolder_Click"/>
                                <Button Content="Copy diagnostics to clipboard" Click="CopyDiagnostics_Click"/>
                            </WrapPanel>
                        </StackPanel>
                    </Border>

                    <Border Background="White" CornerRadius="14" Padding="12" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Preview" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,8"/>
                            <DockPanel Margin="0,0,0,8">
                                <Button Content="Zoom -" Width="70" Click="ZoomOut_Click"/>
                                <Button Content="Zoom +" Width="70" Click="ZoomIn_Click"/>
                                <TextBlock x:Name="ZoomText" Text="100%" VerticalAlignment="Center" Margin="12,0"/>
                            </DockPanel>
                            <Border BorderThickness="1" BorderBrush="#CBD5E1" Height="340">
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <Canvas x:Name="PreviewCanvas" Background="#F8FAFC" MouseLeftButtonDown="PreviewCanvas_MouseLeftButtonDown" MouseMove="PreviewCanvas_MouseMove" MouseLeftButtonUp="PreviewCanvas_MouseLeftButtonUp">
                                        <Image x:Name="PreviewImage" Stretch="None"/>
                                        <Rectangle x:Name="CropRectangle" Stroke="#EF4444" StrokeThickness="2" Fill="#30EF4444" Visibility="Collapsed"/>
                                    </Canvas>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <Border Grid.Column="2" Background="White" CornerRadius="14" Padding="12">
            <StackPanel>
                <TextBlock Text="Device Status" FontSize="22" FontWeight="SemiBold" Margin="0,0,0,8"/>
                <TextBlock x:Name="DeviceNameText" Text="Device: (none)" TextWrapping="Wrap"/>
                <TextBlock x:Name="ConnectionStateText" Text="Connection: Unknown"/>
                <TextBlock x:Name="LastScanText" Text="Last scan: (never)"/>
                <TextBlock x:Name="DriverStateText" Text="Driver status: Unknown" Margin="0,0,0,10"/>
                <WrapPanel>
                    <Button Content="Refresh Devices" Click="RefreshDevices_Click"/>
                    <Button Content="Test Connection" Click="TestConnection_Click"/>
                    <Button Content="Fix It" Click="FixIt_Click"/>
                </WrapPanel>

                <Separator Margin="0,10"/>
                <TextBlock Text="Recent Scans" FontSize="18" FontWeight="SemiBold"/>
                <ListBox x:Name="RecentScansList" Height="420" Margin="0,8,0,0" DisplayMemberPath="DisplayName" SelectionChanged="RecentScansList_SelectionChanged"/>
                <WrapPanel>
                    <Button Content="Open" Click="OpenRecent_Click"/>
                    <Button Content="Reveal" Click="RevealRecent_Click"/>
                </WrapPanel>
                <TextBlock x:Name="StatusMessageText" Text="Ready." Margin="0,8,0,0" TextWrapping="Wrap"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
